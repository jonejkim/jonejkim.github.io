<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />

    <!-- fix for mobile horizontal scrolling being enabled -->
    <meta name="viewport" content="width=device-width, initial-scale = 1.0, maximum-scale=1.0, user-scalable=no" />

    <title>Music Visualization</title>

    <link rel="icon" type="image/png" href="./assets/favicon.png">

    <!-- bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj" crossorigin="anonymous"></script>

    <!-- custom css -->
    <link href="./custom.css" rel="stylesheet" crossorigin="anonymous">

    <!-- d3.js requirements -->
    <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
    <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>

</head>

<body>

    <div id="outermost" class="container-fluid" align="center">
        <br>

        [ <a href="https://vectors-of-qualia.net">Home</a> ] [ <a href="https://github.com/jonejkim/jonejkim.github.io/tree/master/music-vis-d3js">Code</a> ]
        <br>

        <h3>Music Visualization</h3>

        <button id="whatIsThisButton"type="button" class="btn btn-light" data-bs-toggle="collapse" data-bs-target="#whatIsThis">What is this?</button><br><br>
        <div id="whatIsThis" class="collapse">

            <dd>This app attempts to visualize the idea of Discrete Fourier Transform intuitively with music signals.</dd>

            <div class="accordion accordion-flush" id="whatIsThisAccordion">
                <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-h1">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-c1" aria-expanded="false" aria-controls="flush-c1">
                            <div class="accordion-header-text">How?</div>
                        </button>
                    </h2>
                    <div id="flush-c1" class="accordion-collapse collapse" aria-labelledby="flush-h1" >
                        <div class="accordion-body" >
                            <dd>
                                Casually put, I see Fourier Transform as time-spanned inner/dot product of a signal with set of special correlation kernels (Fourier basis) that are orthogonal to among to the other kernels in the set. This operation allows a signal decomposed into multiple signals, which in turn the summation (superposition) of them recovers the original signal.
                            </dd>
                            <dd>
                                A skim through on <a href="https://en.wikipedia.org/wiki/DFT_matrix">DFT Matrix</a> may give you a general idea of how the first principle of Discrete Fourier Transform might work.
                            </dd>

                            <br>
                            <img class="img-fluid" src="assets/fourier.gif"><br>
                            <img class="img-fluid" src="assets/DFTmatrix.png">

                        </div>
                    </div>
                    <h2 class="accordion-header" id="flush-h2">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-c2" aria-expanded="false" aria-controls="flush-c2">
                            <div class="accordion-header-text">Why?</div>
                        </button>
                    </h2>
                    <div id="flush-c2" class="accordion-collapse collapse" aria-labelledby="flush-h2" >
                        <div class="accordion-body" >
                            Music players with visualizations are fun to look at because it is aesthetically pleasing. Being an engineer with knowledge of Fourier Tansforms and its relationship to audio signal processing, I was trying to find a visualization that catches both of aesthetic and mathematical visualization of music, but was not able to find one satisfying within my reach. So I created one myself for the sake of fun and practice.
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-h3">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-c3" aria-expanded="false" aria-controls="flush-c3" text-center>
                            <div class="accordion-header-text">
                                Limitations
                            </div>
                        </button>
                    </h2>
                    <div id="flush-c3" class="accordion-collapse collapse" aria-labelledby="flush-h3" >
                        <div class="accordion-body">
                            Technical Limitations:
                            <dd>
                                This app uses Web Audio API which does not provide phase/angle information on the complex number output of FFT but magnitudes. Therefore fully reconstructing the decomposed frequency components into corresponding waveforms is not possible using this API alone. Meanwhile the amplitude of the decomposed waveforms shown are truthful to that of data, the slow standing-wave-like oscillations are arbitrary dynamics induced using <a href="https://en.wikipedia.org/wiki/Low-frequency_oscillation">Low Frequency Oscillators (LFO)</a> for aesthetics.
                            </dd>
                            Known Issues:
                            <dd>
                                Currently the audio starts clipping following subsequent loads of audio files.
                            </dd>
                            <dd>
                                Volume buttons not working on mobile (android).
                            </dd>
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-h4">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-c4" aria-expanded="false" aria-controls="flush-c4">
                            <div class="accordion-header-text">
                                Credits
                            </div>
                        </button>
                    </h2>
                    <div id="flush-c4" class="accordion-collapse collapse" aria-labelledby="flush-h4" >
                        <div class="accordion-body">
                            <dd><a href="https://github.com/bignerdranch/music-frequency-d3">Example Webapp</a> by bignerdranch used as reference</dd>
                            <dd><a href="https://www.youtube.com/watch?v=cLX0cyh6_Ro">Sample Music: Kubbi - Up In My Jam (No Copyright Music)</a></dd>
                            <dd><a href="https://en.wikipedia.org/wiki/Frequency_domain">Fourier Transform GIF - Wikiepedia</a></dd>
                            <dd><a href="https://en.wikipedia.org/wiki/DFT_matrix">DFT Matrix - Wikiepedia</a></dd>
                            <dd>App powered by D3.js and Bootstrap 5</dd>
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-h4">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-c5" aria-expanded="false" aria-controls="flush-c5">
                            <div class="accordion-header-text">
                                Disclaimer
                            </div>
                        </button>
                    </h2>
                    <div id="flush-c5" class="accordion-collapse collapse" aria-labelledby="flush-h5" >
                        <div class="accordion-body">
                            <dd>This web app does not collect any of your data.</dd>
                        </div>
                    </div>
                </div>
            </div>


        </div>




        <div id="fileInputArea" class="input-group input-group-sm mb-3">
            <!-- <label for="audioFileInput" class="input-group-text" >Load your own</label> -->
            <input id="audioFileInput" type="file" class="form-control form-control-sm" accept="audio/*">
        </div>


        <div id="sampleMusicInfo">
            ... or ...<br>
            Sample Music: <a href="https://www.youtube.com/watch?v=cLX0cyh6_Ro">Kubbi - Up In My Jam (No Copyright Music)</a>
        </div>

        <br>

        <audio id="audioElem" src="./assets/kubbiJam.mp3" crossorigin="anonymous" ></audio>
        <div class="playerUI">
            <button class="btn btn-light" onclick="audioElem.play()">　▶　</button>
            <button class="btn btn-light" onclick="audioElem.pause()">　⏸　</button>
            <button class="btn btn-light" onclick="audioElem.volume+=0.1">Vol ⏶︎</button>
            <button class="btn btn-light" onclick="audioElem.volume-=0.1">Vol ⏷︎</button>
        </div>
        <br>
        <div id="musicVis"></div>
        <br>
        <br>

    </div>


    <script src="constants.js"></script>
    <script src="audioProcess.js"></script>
    <script src="hoverEvent.js"></script>
    <script type="module" src="main.js"></script>

  </body>
</html>
